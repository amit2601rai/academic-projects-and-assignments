package elites.actions;

import elites.model.*;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.sql.*;
import java.io.*;
import java.util.HashMap;

import org.apache.struts.action.Action;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.action.ActionMessage;
import org.apache.struts.action.ActionMessages;

import net.sf.jasperreports.engine.JRExporterParameter;
import net.sf.jasperreports.engine.JasperCompileManager;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.export.JRPdfExporter;
import net.sf.jasperreports.engine.util.JRLoader;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
public class jasperreport extends Action

{  public ActionForward execute(ActionMapping mapping, ActionForm form,
   HttpServletRequest request, HttpServletResponse response)
   throws Exception {
   
	String temp_request=(String)request.getParameter("jchoice");
    int jchoice=Integer.parseInt(temp_request);
	Connection conn=null;String fir="";String area_wise_criminals="";
	PreparedStatement stmt;
	String temp_file=null,temp_file1=null;
	PrintWriter out=response.getWriter();
	//making connection
  try
    {DbModel dm=new DbModel();
	conn=dm.getConnection1();
	System.out.print("connection is"+conn);
	  }
    catch(Exception e)
    {System.out.print("error in conn is "+e);}
	
	
	/*bar chart*/		String age_wise_criminalrecord="<?xml version='1.0' encoding='UTF-8'?><jasperReport xmlns='http://jasperreports.sourceforge.net/jasperreports' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd' name='age_wise_criminalrecord' language='groovy' pageWidth='595' pageHeight='842' columnWidth='555' leftMargin='20' rightMargin='20' topMargin='20' bottomMargin='20'><queryString><![CDATA[select count(psno)as No_of_criminals,age,psno from elite.criminalrecord group by age,psno]]></queryString><field name='NO_OF_CRIMINALS' class='java.lang.Integer'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='AGE' class='java.lang.Long'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='PSNO' class='java.lang.Long'><fieldDescription><![CDATA[]]></fieldDescription></field><background><band splitType='Stretch'/></background><title><band height='51' splitType='Stretch'><staticText><reportElement x='188' y='31' width='154' height='20'/><textElement/><text><![CDATA[AGE WISE CRIMINAL RECORD]]></text></staticText><staticText><reportElement x='0' y='4' width='225' height='20'/><textElement/><text><![CDATA[designed by ECOPS@EliteCleats                  on]]></text></staticText><textField pattern='EEE, d MMM yyyy HH:mm:ss Z'><reportElement x='342' y='0' width='183' height='20'/><textElement/><textFieldExpression class='java.util.Date'><![CDATA[new java.util.Date()]]></textFieldExpression></textField></band></title><pageHeader><band height='49' splitType='Stretch'><staticText><reportElement x='443' y='15' width='110' height='15'/><textElement/><text><![CDATA[Y-Axis-No.Of Criminals        ]]></text></staticText><staticText><reportElement x='443' y='0' width='100' height='15'/><textElement/><text><![CDATA[X-Axis- AGE]]></text></staticText><staticText><reportElement x='443' y='30' width='100' height='19'/><textElement/><text><![CDATA[GROUP by-PS NO.]]></text></staticText></band></pageHeader><columnHeader><band splitType='Stretch'/></columnHeader><detail><band height='214' splitType='Stretch'><barChart><chart><reportElement x='130' y='0' width='293' height='214'/><chartTitle/><chartSubtitle/><chartLegend/></chart><categoryDataset><categorySeries><seriesExpression><![CDATA[$F{PSNO}]]></seriesExpression><categoryExpression><![CDATA[$F{AGE}]]></categoryExpression><valueExpression><![CDATA[$F{NO_OF_CRIMINALS}]]></valueExpression></categorySeries></categoryDataset><barPlot><plot/><itemLabel color='#000000' backgroundColor='#FFFFFF'/><categoryAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></categoryAxisFormat><valueAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></valueAxisFormat></barPlot></barChart></band></detail><columnFooter><band height='35' splitType='Stretch'/></columnFooter><pageFooter><band height='54' splitType='Stretch'/></pageFooter><summary><band height='42' splitType='Stretch'/></summary></jasperReport>";
	/*pie chart*/		String pie_area_wise_criminalrecord="<?xml version='1.0' encoding='UTF-8'?><jasperReport xmlns='http://jasperreports.sourceforge.net/jasperreports' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd' name='pie_area_wise_criminalrecord' language='groovy' pageWidth='595' pageHeight='842' columnWidth='555' leftMargin='20' rightMargin='20' topMargin='20' bottomMargin='20'><queryString><![CDATA[select count(psno) as NO_OF_CRIMES,area,crime from elite.criminalrecord1 group by area,crime]]></queryString><field name='NO_OF_CRIMES' class='java.lang.Integer'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='AREA' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='CRIME' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><background><band splitType='Stretch'/></background><title><band splitType='Stretch'/></title><pageHeader><band height='20' splitType='Stretch'/></pageHeader><columnHeader><band splitType='Stretch'/></columnHeader><detail><band height='248' splitType='Stretch'><pie3DChart><chart><reportElement x='94' y='0' width='363' height='239'/><chartTitle/><chartSubtitle/><chartLegend/></chart><pieDataset><keyExpression><![CDATA[$F{AREA}]]></keyExpression><valueExpression><![CDATA[$F{NO_OF_CRIMES}]]></valueExpression><labelExpression><![CDATA[$F{CRIME}]]></labelExpression></pieDataset><pie3DPlot><plot/><itemLabel color='#000000' backgroundColor='#FFFFFF'/></pie3DPlot></pie3DChart></band></detail><columnFooter><band splitType='Stretch'/></columnFooter><pageFooter><band height='34' splitType='Stretch'/></pageFooter><summary><band height='59' splitType='Stretch'><staticText><reportElement x='0' y='39' width='225' height='20'/><textElement/><text><![CDATA[designed by ECOPS@EliteCleats                  on]]></text></staticText><textField pattern='EEE, d MMM yyyy HH:mm:ss Z'><reportElement x='372' y='39' width='183' height='20'/><textElement/><textFieldExpression class='java.util.Date'><![CDATA[new java.util.Date()]]></textFieldExpression></textField><staticText><reportElement x='202' y='0' width='154' height='20'/><textElement/><text><![CDATA[AREA WISE CRIMINAL RECORD]]></text></staticText></band></summary></jasperReport>"; 
	/*group by crime*/	if(jchoice==3){ area_wise_criminals="<?xml version='1.0' encoding='UTF-8'?><jasperReport xmlns='http://jasperreports.sourceforge.net/jasperreports' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd' name='area_wise_criminals' language='groovy' pageWidth='595' pageHeight='842' columnWidth='555' leftMargin='20' rightMargin='20' topMargin='20' bottomMargin='20'><queryString><![CDATA[select count(psno) as NO_OF_CRIMES,area,crime from elite.criminalrecord1 group by area,crime]]></queryString><field name='NO_OF_CRIMES' class='java.lang.Integer'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='AREA' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='CRIME' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><background><band splitType='Stretch'/></background><title><band height='24' splitType='Stretch'><staticText><reportElement x='0' y='0' width='225' height='20'/><textElement/><text><![CDATA[designed by ECOPS@EliteCleats                  on]]></text></staticText><textField pattern='EEE, d MMM yyyy HH:mm:ss Z'><reportElement x='372' y='0' width='183' height='20'/><textElement/><textFieldExpression class='java.util.Date'><![CDATA[new java.util.Date()]]></textFieldExpression></textField></band></title><pageHeader><band height='57' splitType='Stretch'><staticText><reportElement x='202' y='15' width='154' height='20'/><textElement/><text><![CDATA[AREA WISE CRIMINAL RECORD]]></text></staticText><staticText><reportElement x='438' y='35' width='100' height='19'/><textElement/><text><![CDATA[GROUP by-AREA]]></text></staticText><staticText><reportElement x='438' y='5' width='100' height='15'/><textElement/><text><![CDATA[X-Axis-CRIME ]]></text></staticText><staticText><reportElement x='438' y='20' width='110' height='15'/><textElement/><text><![CDATA[Y-Axis-No.Of Criminals        ]]></text></staticText></band></pageHeader><columnHeader><band splitType='Stretch'/></columnHeader><detail><band height='197' splitType='Stretch'><barChart><chart><reportElement x='139' y='12' width='286' height='174'/><chartTitle/><chartSubtitle/><chartLegend/></chart><categoryDataset><categorySeries><seriesExpression><![CDATA[$F{AREA}]]></seriesExpression><categoryExpression><![CDATA[$F{CRIME}]]></categoryExpression><valueExpression><![CDATA[$F{NO_OF_CRIMES}]]></valueExpression></categorySeries></categoryDataset><barPlot><plot/><itemLabel color='#000000' backgroundColor='#FFFFFF'/><categoryAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></categoryAxisFormat><valueAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></valueAxisFormat></barPlot></barChart></band></detail><columnFooter><band height='37' splitType='Stretch'/></columnFooter><pageFooter><band height='35' splitType='Stretch'/></pageFooter><summary><band height='42' splitType='Stretch'/></summary></jasperReport>";
	/*group by area*/ 	}else{area_wise_criminals="<?xml version='1.0' encoding='UTF-8'?><jasperReport xmlns='http://jasperreports.sourceforge.net/jasperreports' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd' name='area_wise_criminals' language='groovy' pageWidth='595' pageHeight='842' columnWidth='555' leftMargin='20' rightMargin='20' topMargin='20' bottomMargin='20'><queryString><![CDATA[select count(psno) as NO_OF_CRIMES,area,crime from elite.criminalrecord1 group by area,crime]]></queryString><field name='NO_OF_CRIMES' class='java.lang.Integer'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='AREA' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='CRIME' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><background><band splitType='Stretch'/></background><title><band height='24' splitType='Stretch'><staticText><reportElement x='0' y='0' width='225' height='20'/><textElement/><text><![CDATA[designed by ECOPS@EliteCleats                  on]]></text></staticText><textField pattern='EEE, d MMM yyyy HH:mm:ss Z'><reportElement x='372' y='0' width='183' height='20'/><textElement/><textFieldExpression class='java.util.Date'><![CDATA[new java.util.Date()]]></textFieldExpression></textField></band></title><pageHeader><band height='57' splitType='Stretch'><staticText><reportElement x='202' y='15' width='154' height='20'/><textElement/><text><![CDATA[AREA WISE CRIMINAL RECORD]]></text></staticText><staticText><reportElement x='438' y='35' width='100' height='19'/><textElement/><text><![CDATA[GROUP by-CRIME]]></text></staticText><staticText><reportElement x='438' y='5' width='100' height='15'/><textElement/><text><![CDATA[X-Axis- AREA]]></text></staticText><staticText><reportElement x='438' y='20' width='110' height='15'/><textElement/><text><![CDATA[Y-Axis-No.Of Criminals        ]]></text></staticText></band></pageHeader><columnHeader><band splitType='Stretch'/></columnHeader><detail><band height='216' splitType='Stretch'><barChart><chart><reportElement x='131' y='12' width='307' height='189'/><chartTitle/><chartSubtitle/><chartLegend/></chart><categoryDataset><categorySeries><seriesExpression><![CDATA[$F{CRIME}]]></seriesExpression><categoryExpression><![CDATA[$F{AREA}]]></categoryExpression><valueExpression><![CDATA[$F{NO_OF_CRIMES}]]></valueExpression></categorySeries></categoryDataset><barPlot><plot/><itemLabel color='#000000' backgroundColor='#FFFFFF'/><categoryAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></categoryAxisFormat><valueAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></valueAxisFormat></barPlot></barChart></band></detail><columnFooter><band height='62' splitType='Stretch'/></columnFooter><pageFooter><band height='50' splitType='Stretch'/></pageFooter><summary><band height='42' splitType='Stretch'/></summary></jasperReport>";
	}
	/*old*/				String arrestwarrantissued="<?xml version='1.0' encoding='UTF-8'?><jasperReport xmlns='http://jasperreports.sourceforge.net/jasperreports' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd' name='arrestwarrantissued' pageWidth='595' pageHeight='842' columnWidth='555' leftMargin='20' rightMargin='20' topMargin='30' bottomMargin='30'><queryString><![CDATA[(select count(firno) as FIR,DATE,PSNO  from elite.arrestwarrant where provided='true' group by DATE,PSNO)]]></queryString><field name='FIR' class='java.lang.Integer'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='DATE' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='PSNO' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><summary><band height='750' splitType='Stretch'><barChart><chart evaluationTime='Report'><reportElement x='0' y='0' width='555' height='350'/><chartTitle/><chartSubtitle/><chartLegend/></chart><categoryDataset><categorySeries><seriesExpression><![CDATA[$F{PSNO}]]></seriesExpression><categoryExpression><![CDATA[$F{DATE}]]></categoryExpression><valueExpression><![CDATA[$F{FIR}]]></valueExpression></categorySeries></categoryDataset><barPlot isShowTickMarks='false'><plot/><itemLabel color='#000000' backgroundColor='#FFFFFF'/><categoryAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></categoryAxisFormat><valueAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></valueAxisFormat></barPlot></barChart></band></summary></jasperReport>";
	/*new*/				String arrest_warrants_issued="<?xml version='1.0' encoding='UTF-8'?><jasperReport xmlns='http://jasperreports.sourceforge.net/jasperreports' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd' name='arrest_warrants_issued' language='groovy' pageWidth='595' pageHeight='842' columnWidth='555' leftMargin='20' rightMargin='20' topMargin='20' bottomMargin='20'><queryString><![CDATA[select count(firno) as FIR,DATE,PSNO  from elite.arrestwarrant where provided='true' group by DATE,PSNO]]></queryString><field name='FIR' class='java.lang.Integer'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='DATE' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='PSNO' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><background><band splitType='Stretch'/></background><title><band height='25' splitType='Stretch'><staticText><reportElement x='0' y='0' width='225' height='20'/><textElement/><text><![CDATA[designed by ECOPS@EliteCleats                  on]]></text></staticText><textField pattern='EEE, d MMM yyyy HH:mm:ss Z'><reportElement x='362' y='0' width='183' height='20'/><textElement/><textFieldExpression class='java.util.Date'><![CDATA[new java.util.Date()]]></textFieldExpression></textField></band></title><pageHeader><band height='35' splitType='Stretch'><staticText><reportElement x='188' y='15' width='174' height='20'/><textElement textAlignment='Justified'><font size='12' isBold='true'/></textElement><text><![CDATA[ARREST WARRANTS ISSUED]]></text></staticText></band></pageHeader><columnHeader><band splitType='Stretch'/></columnHeader><detail><band height='215' splitType='Stretch'><barChart><chart evaluationTime='Report'><reportElement x='34' y='0' width='466' height='215'/><chartTitle/><chartSubtitle/><chartLegend/></chart><categoryDataset><categorySeries><seriesExpression><![CDATA[$F{PSNO}]]></seriesExpression><categoryExpression><![CDATA[$F{DATE}]]></categoryExpression><valueExpression><![CDATA[$F{FIR}]]></valueExpression></categorySeries></categoryDataset><barPlot isShowTickMarks='false'><plot/><itemLabel color='#000000' backgroundColor='#FFFFFF'/><categoryAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></categoryAxisFormat><valueAxisFormat><axisFormat><labelFont/><tickLabelFont/></axisFormat></valueAxisFormat></barPlot></barChart></band></detail><columnFooter><band splitType='Stretch'/></columnFooter><pageFooter><band splitType='Stretch'/></pageFooter><summary><band height='42' splitType='Stretch'/></summary></jasperReport>"; 
	
	/* fir in pdf*/   	if(jchoice==7){ fir="<?xml version='1.0' encoding='UTF-8'?><jasperReport xmlns='http://jasperreports.sourceforge.net/jasperreports' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd' name='fir' language='groovy' pageWidth='595' pageHeight='842' columnWidth='555' leftMargin='20' rightMargin='20' topMargin='20' bottomMargin='20'><queryString><![CDATA[select * from ELITE.FIR]]></queryString><field name='FIR_NO' class='java.lang.Long'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='C_NO' class='java.lang.Long'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='TIMESTAMP' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='DEPTT' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='TYPECR' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='COPAL' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><background><band splitType='Stretch'/></background><title><band height='32' splitType='Stretch'><staticText><reportElement x='0' y='0' width='225' height='20'/><textElement/><text><![CDATA[designed by ECOPS@EliteCleats                  on]]></text></staticText><textField pattern='EEE, d MMM yyyy HH:mm:ss Z'><reportElement x='362' y='0' width='183' height='20'/><textElement/><textFieldExpression class='java.util.Date'><![CDATA[new java.util.Date()]]></textFieldExpression></textField></band></title><pageHeader><band height='32' splitType='Stretch'><staticText><reportElement x='235' y='0' width='86' height='20'/><textElement textAlignment='Justified'><font size='12' isBold='true'/></textElement><text><![CDATA[   FIR DETAILS]]></text></staticText></band></pageHeader><columnHeader><band height='31' splitType='Stretch'><staticText><reportElement x='0' y='0' width='71' height='20'/><textElement/><text><![CDATA[FIR NO]]></text></staticText><staticText><reportElement x='71' y='0' width='69' height='20'/><textElement/><text><![CDATA[COP ID]]></text></staticText><staticText><reportElement x='140' y='0' width='85' height='20'/><textElement/><text><![CDATA[CRIME]]></text></staticText><staticText><reportElement x='225' y='0' width='126' height='20'/><textElement/><text><![CDATA[TIMESTAMP]]></text></staticText><staticText><reportElement x='351' y='0' width='89' height='20'/><textElement/><text><![CDATA[DEPTT.]]></text></staticText><staticText><reportElement x='445' y='0' width='105' height='20'/><textElement/><text><![CDATA[COP ALLOTTED]]></text></staticText></band></columnHeader><detail><band height='21' splitType='Stretch'><textField><reportElement x='0' y='0' width='71' height='20'/><textElement/><textFieldExpression class='java.lang.Long'><![CDATA[$F{FIR_NO}]]></textFieldExpression></textField><textField><reportElement x='71' y='0' width='69' height='20'/><textElement/><textFieldExpression class='java.lang.Long'><![CDATA[$F{C_NO}]]></textFieldExpression></textField><textField><reportElement x='140' y='0' width='85' height='20'/><textElement/><textFieldExpression class='java.lang.String'><![CDATA[$F{TYPECR}]]></textFieldExpression></textField><textField><reportElement x='225' y='0' width='126' height='20'/><textElement/><textFieldExpression class='java.lang.String'><![CDATA[$F{TIMESTAMP}]]></textFieldExpression></textField><textField><reportElement x='351' y='0' width='89' height='20'/><textElement/><textFieldExpression class='java.lang.String'><![CDATA[$F{DEPTT}]]></textFieldExpression></textField><textField><reportElement x='450' y='0' width='100' height='20'/><textElement/><textFieldExpression class='java.lang.String'><![CDATA[$F{COPAL}]]></textFieldExpression></textField></band></detail><columnFooter><band height='45' splitType='Stretch'><textField><reportElement x='445' y='25' width='100' height='20'/><textElement/><textFieldExpression class='java.lang.Integer'><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression></textField></band></columnFooter><pageFooter><band height='63' splitType='Stretch'/></pageFooter><summary><band height='42' splitType='Stretch'/></summary></jasperReport>";						
	}/*fir in xls*/     else{	 fir="<?xml version='1.0' encoding='UTF-8'?><jasperReport xmlns='http://jasperreports.sourceforge.net/jasperreports' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd' name='fir' language='groovy' pageWidth='595' pageHeight='842' columnWidth='555' leftMargin='20' rightMargin='20' topMargin='20' bottomMargin='20'><queryString><![CDATA[select * from ELITE.FIR]]></queryString><field name='FIR_NO' class='java.lang.Long'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='C_NO' class='java.lang.Long'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='TIMESTAMP' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='DEPTT' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='TYPECR' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><field name='COPAL' class='java.lang.String'><fieldDescription><![CDATA[]]></fieldDescription></field><background><band splitType='Stretch'/></background><title><band height='28' splitType='Stretch'/></title><pageHeader><band height='22' splitType='Stretch'/></pageHeader><columnHeader><band height='31' splitType='Stretch'><staticText><reportElement x='0' y='0' width='71' height='20'/><textElement/><text><![CDATA[FIR NO]]></text></staticText><staticText><reportElement x='71' y='0' width='69' height='20'/><textElement/><text><![CDATA[COP ID]]></text></staticText><staticText><reportElement x='140' y='0' width='85' height='20'/><textElement/><text><![CDATA[CRIME]]></text></staticText><staticText><reportElement x='225' y='0' width='126' height='20'/><textElement/><text><![CDATA[TIMESTAMP]]></text></staticText><staticText><reportElement x='351' y='0' width='89' height='20'/><textElement/><text><![CDATA[DEPTT.]]></text></staticText><staticText><reportElement x='445' y='0' width='105' height='20'/><textElement/><text><![CDATA[COP ALLOTTED]]></text></staticText></band></columnHeader><detail><band height='21' splitType='Stretch'><textField><reportElement x='0' y='0' width='71' height='20'/><textElement/><textFieldExpression class='java.lang.Long'><![CDATA[$F{FIR_NO}]]></textFieldExpression></textField><textField><reportElement x='71' y='0' width='69' height='20'/><textElement/><textFieldExpression class='java.lang.Long'><![CDATA[$F{C_NO}]]></textFieldExpression></textField><textField><reportElement x='140' y='0' width='85' height='20'/><textElement/><textFieldExpression class='java.lang.String'><![CDATA[$F{TYPECR}]]></textFieldExpression></textField><textField><reportElement x='225' y='0' width='126' height='20'/><textElement/><textFieldExpression class='java.lang.String'><![CDATA[$F{TIMESTAMP}]]></textFieldExpression></textField><textField><reportElement x='351' y='0' width='89' height='20'/><textElement/><textFieldExpression class='java.lang.String'><![CDATA[$F{DEPTT}]]></textFieldExpression></textField><textField><reportElement x='450' y='0' width='100' height='20'/><textElement/><textFieldExpression class='java.lang.String'><![CDATA[$F{COPAL}]]></textFieldExpression></textField></band></detail><columnFooter><band height='45' splitType='Stretch'/></columnFooter><pageFooter><band height='63' splitType='Stretch'/></pageFooter><summary><band height='42' splitType='Stretch'/></summary></jasperReport>";						
	}
	switch(jchoice)
	{
	case 1:
			temp_file="age_wise_criminalrecord";
			temp_file1=age_wise_criminalrecord;
	        break;
	case 2:
			temp_file="pie_area_wise_criminalrecord";
			temp_file1=pie_area_wise_criminalrecord;
	        break;
	case 3:
	       temp_file="area_wise_criminals";
		   temp_file1=area_wise_criminals;
		   break;
	case 4:
			temp_file="area_wise_criminals";
			temp_file1=area_wise_criminals;
	        break;
	case 5:
	       temp_file="arrestwarrantsissued";
		   temp_file1=arrestwarrantissued;
		   break;
	case 6:
			temp_file="arrest_warrants_issued";
			temp_file1=arrest_warrants_issued;
	        break;
	case 7:
			temp_file="fir";
			temp_file1=fir;
	        break;
	case 8:
			temp_file="fir";
			temp_file1=fir;
	        break;
	}
	
	//compiling and using jasper report
	try{
		 String filePath = getServlet().getServletContext().getRealPath("/") +"/jasper reports";
		 String filePath1 = getServlet().getServletContext().getRealPath("/") +"/pdf";
		BufferedWriter bw=new BufferedWriter(new FileWriter(filePath+"/temp.jrxml"));
		bw.write(temp_file1);
		bw.close();
		JasperCompileManager.compileReportToFile(filePath+"/temp.jrxml");
		JasperFillManager.fillReportToFile(filePath+"/"+temp_file+".jasper",new HashMap(),conn);
		File file = new File(filePath+"/"+temp_file+".jrprint");
		JasperPrint jasperPrint = (JasperPrint)	JRLoader.loadObject(file);
		JRPdfExporter pdfExporter = new JRPdfExporter();
		pdfExporter.setParameter(JRExporterParameter.JASPER_PRINT, jasperPrint);
		System.out.print(filePath);
		pdfExporter.setParameter(JRExporterParameter.OUTPUT_FILE_NAME,filePath1+"/"+temp_file+".pdf");
		pdfExporter.exportReport();
		conn.close();
		out.println("<a href='/elites/pdf/"+temp_file+".pdf'>click to view the report</a>");
    	}
		catch(Exception e)
		{System.out.print("error is "+e);
		 out.print("<b><font color='black'>ERROR:Causes May Be,</font></b><br/><span style='font-weight:none;'>1.&nbsp;Database Entries May Be Incorrect <br/> 2.&nbsp;There May Be Temporary Error With Our DataBase<br/> Server</span>"+e.toString());
		}
	return null;	
}		
}
